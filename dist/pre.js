import{a as m,b as h}from"./chunk-PFWPZI57.js";import{c as e,e as p}from"./chunk-UJFNRH2W.js";var o=e(p(),1),t=e(m(),1),a=e(h(),1);import s from"node:process";import b from"node:util";async function k(){let r=o.getInput("slack-bot-token")||s.env.SLACK_BOT_TOKEN,u=o.getInput("slack-ts"),i=o.getInput("slack-channel-id"),f=o.getInput("status",{required:!0}),c=o.getInput("github-token",{required:!0}),n=(0,t.getOctokit)(c),_=new a.WebClient(r);if(!r)throw new Error("Missing input slack-bot-token or environment variable SLACK_BOT_TOKEN");if(!u)if(i){let g=await n.paginate(n.rest.actions.listJobsForWorkflowRunAttempt,{...t.context.repo,run_id:t.context.runId,attempt_number:Number.parseInt(s.env.GITHUB_RUN_ATTEMPT||"1",10)}),l=[{label:"Author",url:`https://github.com/${t.context.actor}`,value:t.context.actor}];t.context.payload.repository?.html_url&&l.push({label:"Repo",url:t.context.payload.repository.html_url,value:t.context.payload.repository.name}),t.context.payload.pull_request?.html_url&&l.push({label:"PR",url:t.context.payload.pull_request.html_url,value:`#${t.context.payload.pull_request.number}`}),console.log(JSON.stringify(t.context,null,2))}else throw new Error("missing input slack-ts or channel-id")}k().catch(r=>{o.error(b.format(r))});export{k as run};
